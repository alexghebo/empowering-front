{"version":3,"sources":["../../../src/js/custom/edit-about-modal.js"],"names":["$","document","ready","userId","cookie","authToken","ajax","type","url","baseUrl","headers","Authorization","crossDomain","success","response","allResources","data","val","description","userResources","resources","resourcesHtml","hide","i","length","resourceTemplate","clone","show","appendTo","find","html","name","attr","id","j","quantity","submitAboutModal","on","valueInput","console","log","inputParse","parseInt","newVal","replace","selectedResources","each","push","resourceId","filtered","filter","el","payload","JSON","stringify","contentType","location","reload","error","err","alert","message"],"mappings":"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","sourcesContent":["$(document).ready(function () {\n  let userId = $.cookie(\"authUserId\");\n  let authToken = $.cookie(\"authToken\");\n\n  $.ajax({\n    type: \"GET\",\n    url: baseUrl + \"/api/resources\",\n    headers: { Authorization: \"Bearer \" + authToken },\n    crossDomain: true,\n    success: function (response) {\n      var allResources = response;\n      $.ajax({\n        type: \"GET\",\n        url: baseUrl + \"/api/users/\" + userId,\n        headers: { Authorization: \"Bearer \" + authToken },\n        crossDomain: true,\n        success: function (data) {\n          $(\".description-user\").val(data.description);\n          var userResources = data.resources;\n          var resourcesHtml = $(\"#resource-template\");\n          resourcesHtml.hide();\n          for (var i = 0; i < allResources.length; i++) {\n            var resourceTemplate = resourcesHtml.clone();\n            resourceTemplate.show().appendTo(\".resources-list\");\n            resourceTemplate.find(\"#resource-name\").html(allResources[i].name);\n            resourceTemplate\n              .find(\"input\")\n              .attr(\"data-resource-id\", allResources[i].id);\n            resourceTemplate\n              .find(\"input\")\n              .attr(\"data-resource-name\", allResources[i].name);\n            for (var j = 0; j < userResources.length; j++) {\n              if (allResources[i].id === userResources[j].id) {\n                resourceTemplate\n                  .find(\"input\")\n                  .attr(\"value\", userResources[j].quantity);\n              }\n            }\n          }\n        },\n      });\n    },\n  });\n  submitAboutModal(userId, authToken);\n\n  $(document).on(\"keyup\", \"input.resource-input\", function () {\n    var valueInput = $(this).val();\n    console.log(valueInput);\n    var inputParse = parseInt(valueInput);\n    var newVal = $(this).val().replace(\"-\", '');\n    $(this).val(newVal);\n  });\n\n  $(document).on(\"keyup\", \"input#resource-edit-input\", function () {\n    var newVal = $(this).val().replace(\"-\", '0');\n    $(this).val(newVal);\n  })\n});\nfunction submitAboutModal(userId, authToken) {\n  $(\".submit-edit-about-modal\").on(\"click\", function () {\n    var description = $(\".description-user\").val();\n    var resources = [];\n\n    var selectedResources = [];\n    $(\".resources-list #resource-template\").each(function () {\n      selectedResources.push({\n        resourceId: $(this).find(\"input\").attr(\"data-resource-id\"),\n        name: $(this).find(\"input\").attr(\"data-resource-name\"),\n        quantity: $(this).find(\"input\").val(),\n      });\n    });\n    var filtered = selectedResources.filter(function (el) {\n      return el.quantity !== \"0\" && el.quantity !== \"\";\n    });\n    var payload = [\n      {\n        description: description,\n        resources: filtered,\n      },\n    ];\n    $.ajax({\n      type: \"PUT\",\n      url: baseUrl + \"/api/users/\" + userId + \"/about\",\n      headers: { Authorization: \"Bearer \" + authToken },\n      crossDomain: true,\n      data: JSON.stringify({\n        description: description,\n        resources: filtered,\n      }),\n      contentType: \"application/json\",\n      success: function (data) {\n        location.reload(true);\n      },\n      error: function (err) {\n        alert(err.message);\n      },\n    });\n  });\n}\n"],"file":"edit-about-modal.js"}