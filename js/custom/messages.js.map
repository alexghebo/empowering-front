{"version":3,"sources":["../../../src/js/custom/messages.js"],"names":["$","document","ready","on","checked","find","attr","tagSelectorInit","sortConnection","uploadPictures","sendMessagesPressingEnter","sendMessageClickingButton","submitCreateGroup","sortAddMembersToGroup","deleteUserFromGroup","addMembersToGroup","deleteMessageAttachment","submitEditGroup","userIds","files","name","length","substring","text","e","preventDefault","userId","authToken","cookie","console","log","uploadProfilePicture","event","jsonArray","FormData","append","key","entries","opts","url","baseUrl","data","cache","contentType","processData","method","async","type","headers","Authorization","success","id","ajax","location","reload","fake","xhr","jQuery","ajaxSettings","send","sendAsBinary","boundary","toString","crossDomain","connections","i","push","val","removeAttr","css","height","window","overflowY","position","paddingTop","scrollTop","prop","listMessagesFrientList","filterUserMessages","addNewContactMessage","children","each","removeClass","addClass","changeContent","newMessageNotif","setTimeout","newConversations","lastMessage","status","eq","hasClass","complete","timeout","liveMessages","activeTabUserId","oldMessages","newMessages","switched","poll","newTabUserId","senderId","diffMessagesLength","diffmessages","j","k","message","userName","profilePic","profilePicture","groupTemplate","group","newUserMessageTemplate","appendTo","onload","connectionsUser","messageListIitem","profilePictureMessages","messageListTemplate","clone","entityId","html","profilePictureId","changeContentNoMessage","profileGroup","contentInfo","admin","memberGroupTemplate","profilePictureAdmin","profileGroupMember","response","membersGroup","members","groupId","contentAddMember","filteredMembers","adminGroup","userConnections","map","conn","includes","noAdminGroupMembers","el","member","pic","showEmail","email","hide","domains","beforeSend","setRequestHeader","userDomainBadge","loadConversation","showSharedFiles","lastMessageId","value","toLowerCase","toggle","indexOf","select2","templateResult","formatState","domainTemplate","connectionMessageTemplate","connectionId","profilePictureAddMemberTemplate","userType","profilePictureMessagesGroup","bind","is","error","alert","state","$state","element","content","messagesInfoSharedFile","fileNameMessage","title","paddingFiles","keypress","keyCode","shiftKey","sendMessage","attachId","fileName","attachemntIds","getAll","fileNameCreatePost","recieverId","currentUserIdToken","attachmentId","templateMessage","iconUserCircle","messagesTemplate","authUserId","conversationsUnread","userMessage","thirdPartyMessage","templateMessages","show","prepend","newMessage","nameGroup","JSON","stringify","memberId","parent","remove","uploads","submit","attachmentIds","attachments"],"mappings":"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","sourcesContent":["$(document).ready(function () {\n  $(document).on(\"click\", \"#content-user-group\", function () {\n    var checked = $(this).find(\"input#input-group-users\").attr(\"checked\");\n    $(this).find(\"input#input-group-users\").attr(\"checked\", !checked);\n  });\n  tagSelectorInit();\n  sortConnection();\n  uploadPictures();\n  sendMessagesPressingEnter();\n  sendMessageClickingButton();\n  submitCreateGroup();\n  sortAddMembersToGroup();\n  deleteUserFromGroup();\n  addMembersToGroup();\n  deleteMessageAttachment();\n  submitEditGroup();\n  var userIds = [];\n  $(document).on(\"change\", \"input#upload-profile-group-input\", function () {\n    var files = $(\"input#upload-profile-group-input\")[0].files[0].name;\n    if (files.length > 20) {\n      files = files.substring(0, 20) + \"[...]\";\n    }\n    $(\"span#file-name\").text(files);\n  });\n\n  $(document).on(\"submit\", \"form#upload-profile-group-form\", function (e) {\n    e.preventDefault();\n    var userId = $(this).attr(\"data-group-id\");\n    var authToken = $.cookie(\"authToken\");\n    console.log(userId);\n    uploadProfilePicture(userId, authToken);\n  });\n\n  async function uploadProfilePicture(userId, authToken) {\n    //stop submit the form, we will post it manually.\n    event.preventDefault();\n\n    const jsonArray = new FormData();\n    if ($(\"input#upload-profile-group-input\")[0].files.length) {\n      jsonArray.append(\n        \"attachment\",\n        $(\"input#upload-profile-group-input\")[0].files[0]\n      );\n      jsonArray.append(\n        \"title\",\n        $(\"input#upload-profile-group-input\")[0].files[0].name\n      );\n      for (var key of jsonArray.entries()) {\n        console.log(key[0] + \", \" + key[1]);\n      }\n\n      var opts = {\n        url: baseUrl + \"/api/attachments\",\n        data: jsonArray,\n        cache: false,\n        contentType: false,\n        processData: false,\n        method: \"POST\",\n        async: false,\n        type: \"POST\", // For jQuery < 1.9\n        headers: { Authorization: \"Bearer \" + authToken },\n        success: function (data) {\n          var id = data.id;\n\n          $.ajax({\n            type: \"POST\",\n            url:\n              baseUrl +\n              \"/api/users/\" +\n              userId +\n              \"/profilePictureForMessageGroup\",\n            contentType: \"text/plain\",\n            async: false,\n            headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n            data: id,\n            success: function () {\n              location.reload(true);\n            },\n          });\n        },\n      };\n      if (jsonArray.fake) {\n        // Make sure no text encoding stuff is done by xhr\n        opts.xhr = function () {\n          var xhr = jQuery.ajaxSettings.xhr();\n          xhr.send = xhr.sendAsBinary;\n          return xhr;\n        };\n        opts.contentType =\n          \"multipart/form-data; boundary=\" + jsonArray.boundary;\n        opts.data = jsonArray.toString();\n      }\n      jQuery.ajax(opts);\n    }\n  }\n\n  $.ajax({\n    type: \"GET\",\n    url: baseUrl + \"/api/users/\" + $.cookie(\"authUserId\"),\n    headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n    async: false,\n    crossDomain: true,\n    success: function (data) {\n      if (data.connections.length) {\n        for (var i = 0; i < data.connections.length; i++) {\n          userIds.push(data.connections[i].userId);\n        }\n      }\n    },\n  });\n  $(document).on(\"hidden.bs.modal\", \"div#create-group-modal\", function () {\n    $(\"input#name-group\").val(\"\");\n    $(\"input#input-group-users\").removeAttr(\"checked\");\n  });\n  $(\".message-page-wrapper\").css({\n    height: $(window).height() - 57,\n    overflowY: \"auto\",\n  });\n  $(\".message-page-wrapper-content\").css({\n    height: $(window).height() - 157,\n    overflowY: \"auto\",\n    position: \"relative\",\n    paddingTop: \"30px\",\n  });\n  $(\".user-type-message\")\n    .css({\n      height: 100,\n      overflowY: \"auto\",\n    })\n    .scrollTop(0);\n  $(\".message-page-wrapper-content\").scrollTop(\n    $(\".message-page-wrapper-content\").prop(\"scrollHeight\")\n  );\n  listMessagesFrientList();\n\n  filterUserMessages();\n  addNewContactMessage();\n\n  $(\".connections-search-select2\").on(\"change\", function () {\n    var userId = $(this).find(\"option:selected\").attr(\"data-user-id\");\n    $(\".messages-list\")\n      .children()\n      .each(function () {\n        $(this).removeClass(\"active\");\n      });\n    $(\".messages-list\")\n      .find(\"a[data-user-id=\" + userId + \"]\")\n      .addClass(\"active\")\n      .addClass(\"show\");\n\n    $(\"#v-pills-new-message\").removeClass(\"active\").removeClass(\"show\");\n    $(\"#v-pills-home\")\n      .addClass(\"active\")\n      .addClass(\"show\")\n      .attr(\"data-user-id\", userId);\n\n    $(\".messages-content\").addClass(\"col-xl-8\").removeClass(\"col-xl-12\");\n    $(\".sidebar-right-content\").removeClass(\"d-none\");\n    changeContent(userId);\n  });\n\n  (function newMessageNotif() {\n    setTimeout(function () {\n      $.ajax({\n        type: \"GET\",\n        url: baseUrl + \"/api/users/conversations\",\n        headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n        async: false,\n        success: function (data) {\n          var newConversations = data;\n          for (var i = 0; i < newConversations.length; i++) {\n            if (newConversations[i].lastMessage) {\n              if (newConversations[i].lastMessage.status === \"UNREAD\") {\n                if (\n                  !$(\".messages-list\")\n                    .children()\n                    .eq(i + 1)\n                    .hasClass(\"active\")\n                ) {\n                  $(\".messages-list\")\n                    .children()\n                    .eq(i + 1)\n                    .find(\"span#chat-menu-user-name\")\n                    .addClass(\"font-weight-bold\");\n                } else {\n                  $.ajax({\n                    type: \"POST\",\n                    url:\n                      baseUrl +\n                      \"/api/users/message/\" +\n                      newConversations[i].lastMessage.id +\n                      \"/change-status\",\n                    headers: {\n                      Authorization: \"Bearer \" + $.cookie(\"authToken\"),\n                    },\n                    contentType: \"application/x-www-form-urlencoded\",\n                    success: function () {},\n                  });\n                }\n              }\n            }\n          }\n          // }\n        },\n        complete: newMessageNotif,\n        timeout: 200,\n      });\n    }, 5000);\n  })();\n\n  var liveMessages = function () {\n    var activeTabUserId = $(\".nav-link.active.show\").attr(\"data-user-id\");\n\n    var oldMessages = [];\n    var newMessages = [];\n    var switched = false; // on page load and changes its value when clicking on other user tab\n    $.ajax({\n      type: \"GET\",\n      url: baseUrl + \"/api/users/conversation/\" + activeTabUserId,\n      headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n      crossDomain: true,\n      async: false,\n      success: function (data) {\n        oldMessages = data;\n      },\n    });\n\n    (function poll() {\n      setTimeout(function () {\n        var newTabUserId = $(\".nav-link.active.show\").attr(\"data-user-id\");\n\n        $.ajax({\n          type: \"GET\",\n          url: baseUrl + \"/api/users/conversation/\" + activeTabUserId,\n          headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n          crossDomain: true,\n          async: false,\n          success: function (data) {\n            if (activeTabUserId === newTabUserId) {\n              newMessages = data;\n\n              if (oldMessages.length !== newMessages.length) {\n                if (!switched) {\n                  if (\n                    newMessages[newMessages.length - 1].senderId !==\n                    $.cookie(\"authUserId\")\n                  ) {\n                    var diffMessagesLength =\n                      newMessages.length - oldMessages.length;\n\n                    var diffmessages = [];\n                    for (var j = 0; j < newMessages.length; j++) {\n                      if (j > oldMessages.length - 1) {\n                        if (\n                          newMessages[j].senderId !== $.cookie(\"authUserId\")\n                        ) {\n                          diffmessages.push(newMessages[j]);\n                        }\n                      }\n                    }\n\n                    for (var k = 0; k < diffmessages.length; k++) {\n                      var message = diffmessages[k];\n                      $.ajax({\n                        type: \"GET\",\n                        url: baseUrl + \"/api/users/\" + message.senderId,\n                        headers: {\n                          Authorization: \"Bearer \" + $.cookie(\"authToken\"),\n                        },\n                        async: false,\n                        crossDomain: true,\n                        success: function (data) {\n                          var userName = data.name;\n                          var profilePic = ``;\n                          if (data.profilePicture) {\n                            profilePic = `\n          <div class=\"icon-user-circle\" style=\"opacity: 1 !important;\"> \n              <img class=\"profile-picture-chat-list\" src=\"https://api.youth-initiatives.com/api/attachments/${data.profilePicture}\">\n          </div>`;\n                          } else {\n                            profilePic = `\n          <div class=\"icon-user-circle\" style=\"opacity: .7;\">\n            <img src=\"assets/img/icons/user-avatar-orange.svg\" alt=\"Profile Picture\" title=\"Profile Picture\" />\n          </div>`;\n                          }\n                          var groupTemplate = ``;\n                          if (message.group) {\n                            groupTemplate = `<div class=\"ml-4 text-muted\">${userName}</div>`;\n                          }\n                          var newUserMessageTemplate = `\n          <div class=\"user-third-party-message\" style=\"\">${groupTemplate}\n    <div class=\"d-flex align-items-start\">\n        <div class=\"px-2 px-md-4 d-flex\">\n          <div class=\"profile-picture-user-messages\">\n          <a href=\"user-profile-view.html?userId=${data.userId}\">\n      ${profilePic}\n      </a>\n        </div>\n        <div class=\"message ml-4\">\n            <p class=\"m-0\" id=\"content-message-third-party-user\">${message.message}</p>\n        </div>\n    </div>\n</div>\n                            `;\n                          $(newUserMessageTemplate).appendTo(\n                            \".message-page-wrapper-content\"\n                          );\n                        },\n                      });\n                    }\n\n                    console.log(diffmessages);\n\n                    oldMessages = newMessages;\n                  }\n                } else {\n                  switched = false;\n                  oldMessages = newMessages;\n                }\n              }\n            } else {\n              console.log(\"user changed!\");\n              activeTabUserId = newTabUserId;\n\n              $.ajax({\n                type: \"GET\",\n                url: baseUrl + \"/api/users/conversation/\" + activeTabUserId,\n                headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n                crossDomain: true,\n                async: false,\n                success: function (data) {\n                  oldMessages = data;\n                  console.log(\"switched old \" + oldMessages.length);\n                  switched = true;\n                },\n              });\n            }\n          },\n          complete: poll,\n          timeout: 200,\n        });\n      }, 5000);\n    })();\n  };\n  window.onload = function () {\n    setTimeout(liveMessages, 5000);\n  };\n});\nfunction listMessagesFrientList() {\n  let userId = $.cookie(\"authUserId\");\n  let authToken = $.cookie(\"authToken\");\n  $.ajax({\n    type: \"GET\",\n    url: baseUrl + \"/api/users/conversations\",\n    headers: { Authorization: \"Bearer \" + authToken },\n    crossDomain: true,\n    success: function (data) {\n      var connectionsUser = data;\n      var messageListIitem = $(\"a#messages-list-item\");\n      messageListIitem.addClass(\"d-none\");\n      for (var i = 0; i < connectionsUser.length; i++) {\n        var profilePictureMessages = ``;\n        var messageListTemplate = messageListIitem.clone();\n        messageListTemplate.removeClass(\"d-none\").appendTo(\".messages-list\");\n        messageListTemplate.attr(\"data-user-id\", connectionsUser[i].entityId);\n        messageListTemplate\n          .find(\"span#chat-menu-user-name\")\n          .html(connectionsUser[i].name);\n        if (connectionsUser[i].lastMessage) {\n          messageListTemplate.attr(\n            \"data-last-message\",\n            connectionsUser[i].lastMessage.id\n          );\n          if (connectionsUser[i].lastMessage.status === \"UNREAD\") {\n            messageListTemplate\n              .find(\"span#chat-menu-user-name\")\n              .addClass(\"font-weight-bold\");\n          }\n        }\n\n        if (connectionsUser[i].profilePictureId) {\n          profilePictureMessages = `\n          <div class=\"icon-user-circle\" style=\"opacity: 1 !important;\"> \n            <img class=\"profile-picture-chat-list\" src=\"https://api.youth-initiatives.com/api/attachments/${connectionsUser[i].profilePictureId}\">\n          </div>`;\n        } else {\n          profilePictureMessages = `\n          <div class=\"icon-user-circle\">\n            <img src=\"assets/img/icons/user-avatar-orange.svg\" alt=\"Profile Picture\" title=\"Profile Picture\" />\n          </div>`;\n        }\n\n        messageListTemplate.find(\".icon-wrapper\").html(profilePictureMessages);\n        if (i === 0) {\n          messageListTemplate.addClass(\"active\").addClass(\"show\");\n          if (connectionsUser[i].lastMessage) {\n            changeContent(\n              connectionsUser[i].entityId,\n              connectionsUser[i].lastMessage.id\n            );\n          } else {\n            changeContentNoMessage(connectionsUser[i].entityId);\n          }\n        }\n      }\n    },\n  });\n}\nfunction changeContentNoMessage(userId) {\n  $(\".sidebar-right-content\").addClass(\"d-none d-xl-block\");\n\n  $.ajax({\n    type: \"GET\",\n    url: baseUrl + \"/api/users/userConversation/\" + userId,\n    headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n    crossDomain: true,\n    success: function (data) {\n      var profileGroup = ``;\n\n      var contentInfo = ``;\n      if (data.admin) {\n        var memberGroupTemplate = ``;\n        var admin = data.admin;\n        var profilePictureAdmin = ``;\n        var profileGroupMember = ``;\n        $.ajax({\n          type: \"GET\",\n          url: baseUrl + \"/api/users/\" + admin,\n          async: false,\n          headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n          success: function (response) {\n            if (response.profilePicture) {\n              profilePictureAdmin = `\n          <div class=\"icon-user-circle\" style=\"opacity: 1 !important;\"> \n            <img class=\"profile-picture-chat-list\" src=\"https://api.youth-initiatives.com/api/attachments/${response.profilePicture}\">\n          </div>`;\n            } else {\n              profilePictureAdmin = `\n              <div class=\"icon-user-circle\">\n                <img src=\"assets/img/icons/user-avatar-orange.svg\" alt=\"Profile Picture\" title=\"Profile Picture\" />\n            </div>\n              `;\n            }\n            memberGroupTemplate += `\n            <div class=\"members d-flex justify-content-between align-items-center px-3 py-2\">\n              <div class=\"d-flex align-items-center\">\n              <a href=\"user-profile-view.html?userId=${response.userId}\">\n                ${profilePictureAdmin}\n              </a>\n                <p class=\"mb-0 ml-2\">\n                  <a class=\"text-muted text-decoration-none\" href=\"user-profile-view.html?userId=${response.userId}\">\n                    ${response.name}\n                  </a>\n              </p>\n              </div>\n              <div class=\"mb-0 ml-4\">Admin</div>\n            </div>`;\n          },\n        });\n        var membersGroup = data.members;\n        var groupId = data.userId;\n\n        for (var k = 0; k < membersGroup.length; k++) {\n          $.ajax({\n            type: \"GET\",\n            url: baseUrl + \"/api/users/\" + membersGroup[k],\n            headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n            async: false,\n            success: function (response) {\n              if (response.profilePicture) {\n                profileGroupMember = `\n                <div class=\"icon-user-circle\" style=\"opacity: 1 !important;\"> \n                  <img class=\"profile-picture-chat-list\" src=\"https://api.youth-initiatives.com/api/attachments/${response.profilePicture}\">\n                </div>`;\n              } else {\n                profileGroupMember = `\n                  <div class=\"icon-user-circle\">\n                    <img src=\"assets/img/icons/user-avatar-orange.svg\" alt=\"Profile Picture\" title=\"Profile Picture\" />\n                  </div>`;\n              }\n              memberGroupTemplate += `\n                <div class=\"members d-flex justify-content-between px-3 py-2\">\n                  <div class=\"d-flex align-items-center\">\n                    ${profileGroupMember}\n                    <p class=\"mb-0 ml-2\">\n                      <a class=\"text-muted text-decoration-none\" href=\"user-profile-view.html?userId=${response.userId}\">\n                        ${response.name}\n                      </a>\n                    </p>\n                  </div>\n                  <button class=\"bg-transparent border-0 d-none-if-profile-view dropdown-toggle ml-2\" id=\"edit-group-button-1\" type=\"button\" data-toggle=\"dropdown\" aria-expanded=\"false\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 32 32\">\n                      <defs>\n                        <style> \n                          .stroke {\n                            fill: none;\n                            stroke: transparent;\n                          }\n\n                          .b {\n                            fill: #808e9b;\n                          }\n                        </style>\n                      </defs>\n                      <g transform=\"translate(-1318 -447)\">\n                        <rect class=\"stroke\" width=\"32\" height=\"32\" rx=\"4\" transform=\"translate(1318 447)\"></rect>\n                        <circle class=\"b\" cx=\"2\" cy=\"2\" r=\"2\" transform=\"translate(1326 461)\"></circle>\n                        <circle class=\"b\" cx=\"2\" cy=\"2\" r=\"2\" transform=\"translate(1332 461)\"></circle>\n                        <circle class=\"b\" cx=\"2\" cy=\"2\" r=\"2\" transform=\"translate(1338 461)\"></circle>\n                      </g>\n                    </svg>\n                  </button>\n                  <div class=\"dropdown-menu\" aria-labelledby=\"#edit-group-button-3\">\n                    <a class=\"dropdown-item\" id=\"delete-user-from-group\" data-delete-id=\"${response.userId}\">Delete user</a></div>\n                </div>`;\n            },\n          });\n        }\n        if (data.profilePicture) {\n          profileGroup = `\n            <div class=\"icon-user-circle-overflow-auto position-relative\" id=\"messages-user-info-profile-picture-image\" style=\"opacity: 1 !important;\">\n              <div class=\"profile-picture-group-wrapper d-flex align-items-center justify-content-center overflow-hidden\">\n                <img class=\"profile-picture-group h-100\" src=\"https://api.youth-initiatives.com/api/attachments/${data.profilePicture}\">\n              </div>\n              <button class=\"button-upload-photo position-absolute\" id=\"upload-group-image\" data-toggle=\"modal\" data-target=\"#modal-upload-picture-group\">\n                <div class=\"icon-user-circle\" id=\"upload-group\"><i class=\"cil-camera\"></i></div>\n              </button>\n            </div>`;\n        } else {\n          profileGroup = `\n  <div class=\"icon-user-circle-overflow-auto position-relative\" id=\"messages-user-info-profile-picture-image\">\n    <svg id=\"icon-user-group\" xmlns=\"http://www.w3.org/2000/svg\" width=\"17\" height=\"19\" viewBox=\"0 0 17 19\">\n      <defs>\n        <style>\n          .a {\n            fill: none;\n            stroke: #1e272e;\n            stroke-linecap: round;\n            stroke-linejoin: round;\n          }\n        </style>\n      </defs>\n      <g transform=\"translate(-5.5 -4)\">\n        <path class=\"a\" d=\"M22,28.5v-2a4,4,0,0,0-4-4H10a4,4,0,0,0-4,4v2\" transform=\"translate(0 -6)\"></path>\n        <path class=\"a\" d=\"M20,8.5a4,4,0,1,1-4-4,4,4,0,0,1,4,4Z\" transform=\"translate(-2 0)\"></path>\n      </g>\n    </svg>\n    <button class=\"button-upload-photo position-absolute\" id=\"upload-group-image\" data-toggle=\"modal\" data-target=\"#modal-upload-picture-group\">\n      <div class=\"icon-user-circle\" id=\"upload-group\"><i class=\"cil-camera\"></i></div>\n    </button>\n  </div>\n  `;\n        }\n\n        var contentAddMember = ``;\n        var members = data.members;\n        var filteredMembers = [];\n        var entityId = data.userId;\n        var adminGroup = data.admin;\n        $.ajax({\n          type: \"GET\",\n          url: baseUrl + \"/api/users/\" + $.cookie(\"authUserId\"),\n          async: false,\n          headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n          success: function (response) {\n            let userConnections = response.connections;\n            userConnections.map((conn) => {\n              if (!members.includes(conn.userId)) {\n                filteredMembers.push(conn.userId);\n              }\n            });\n          },\n        });\n\n        const noAdminGroupMembers = [];\n\n        filteredMembers.map((el) => {\n          if (adminGroup !== el) {\n            noAdminGroupMembers.push(el);\n          }\n        });\n\n        noAdminGroupMembers.map((member) => {\n          $.ajax({\n            type: \"GET\",\n            url: baseUrl + \"/api/users/\" + member,\n            async: false,\n            headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n            success: function (response) {\n              var pic = ``;\n              if (response.profilePicture) {\n                pic = `\n                <div class=\"icon-user-circle\" style=\"opacity: 1 !important;\"> \n              <img class=\"profile-picture-chat-list\" src=\"https://api.youth-initiatives.com/api/attachments/${response.profilePicture}\">\n          </div>`;\n              } else {\n                pic = `<div class=\"icon-user-circle\">\n                <img src=\"assets/img/icons/user-avatar-orange.svg\" alt=\"Profile Picture\" title=\"Profile Picture\" />\n            </div>`;\n              }\n              contentAddMember += `\n              <div class=\"row py-2 no-gutters align-items-center justify-content-between\" id=\"content-user-group\">\n                    <div class=\"col-auto px-3 w-25 d-flex align-items-center\">\n                    <input type=\"checkbox\" data-user-group-id=\"${member}\" id=\"input-group-users\">\n                      <div class=\"icon-wrapper\">\n                          ${pic}\n                    </div>\n                  </div>\n                  <div class=\"col\">\n                    <span class=\"pl-3\" id=\"user-member-name\">\n                        ${response.name}\n                    </span>\n                  </div>\n                </div>`;\n            },\n          });\n        });\n        contentInfo = `\n        <div class=\"c-sidebar-nav right-sidebar-members-menu d-none d-xl-block\">\n          <div class=\"border-bottom d-flex align-items-center justify-content-center flex-column pb-4\">\n            ${profileGroup}\n            <div id=\"message-board-name\" class=\"font-weight-bold mt-3 mb-0\" data-group-id=${data.userId}></div>\n            <button class=\"border-0 a add-new-group-message bg-transparent ml-2 mt-2 mb-2 mr-1 p-0 m-0\" type=\"button\" data-toggle=\"modal\" data-target=\"#edit-group-modal\">\n            <img src=\"assets/img/icons/edit.png\" style=\"width:20px; heigth:auto;\" alt=\"Add contact\" title=\"Add contact\" />\n            </button>     \n            </div>\n          <div class=\"members-group\">\n            <p class=\"text-muted font-weight-bold mt-3 px-3\">MEMBERS</p>\n            <div class=\"content-members\">\n              <div class=\"add-member d-flex align-items-center px-3 py-2\" data-toggle=\"modal\" data-target=\"#modal-add-member-to-group\">\n                <div class=\"icon-user-circle mr-2\"><i class=\"cil-plus\"></i></div>\n                <p class=\"m-0\">Add member</p>\n              </div>\n                ${memberGroupTemplate}\n            </div>\n          </div>\n        </div>\n        <div class=\"modal\" tabindex=\"-1\" role=\"dialog\" id=\"modal-upload-picture-group\" aria-modal=\"true\" data-user-id = ${data.userId}>\n          <div class=\"modal-dialog\" role=\"document\">\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h5 class=\"modal-title\">Upload group picture</h5>\n                <button class=\"close text-dark\" type=\"button\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\"></span></button>\n              </div>\n              <form class=\"p-3\" id=\"upload-profile-group-form\" data-group-id=\"${data.userId}\">\n                <input id=\"upload-profile-group-input\" type=\"file\" style=\"display: none\" name=\"attachment\" accept=\"image/*\">\n                <div class=\"row\">\n                  <div class=\"col-sm-6\">\n                    <label class=\"custom-file-upload-label choose-file-shared-files d-flex align-items-center justify-content-center\" for=\"upload-profile-group-input\">\n                      <div>\n                        <div class=\"text-center mb-3\"><i class=\"cil-cloud-download\"></i></div>\n                        <div class=\"text-center\">Click here to upload<br>your file</div>\n                      </div>\n                    </label>\n                  </div>\n                  <div class=\"col-sm-6 text-wrap\">\n                    <p class=\"d-flex align-items-center file-name-attachment\"><span class=\"d-none file-icon\"><i class=\"cil-file\"></i></span><span id=\"file-name\"></span></p>\n                  </div>\n                </div>\n                <div class=\"modal-footer\">\n                  <button class=\"btn btn-secondary\" type=\"button\" data-dismiss=\"modal\">Close</button>\n                  <button class=\"btn btn-primary\" id=\"btnSubmit\" type=\"submit\">Submit</button>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal\" tabindex=\"-1\" role=\"dialog\" id=\"modal-add-member-to-group\" aria-modal=\"true\">\n          <div class=\"modal-dialog\" role=\"document\">\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h5 class=\"modal-title\">Add member</h5>\n                <button class=\"close text-dark\" type=\"button\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\"></span></button>\n              </div>\n              <form id=\"add-member-to-group-form\" data-groupid=\"${groupId}\">\n                <div class=\"modal-body\">\n                  <p class=\"p-0 mb-1\">Add member to your group</p>\n                  <input class=\"form-control pl-2\" id=\"search-add-members\" type=\"text\" placeholder=\"Search members\" aria-label=\"Username\" aria-describedby=\"basic-addon1\">\n                  <div class=\"content-members-group\">\n                    ${contentAddMember}\n              </div>\n            </div>\n            <div class=\"modal-footer\">\n              <button class=\"btn btn-secondary\" type=\"button\" data-dismiss=\"modal\">Close</button>\n              <button class=\"btn btn-primary\" id=\"add-member-button\" type=\"submit\">Submit</button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>`;\n        $(\"#message-board-name\").html(`<span>${data.name}</span>`);\n      } else {\n        contentInfo = `\n          <div class=\"c-sidebar-nav right-sidebar-members-menu d-none d-xl-block\">\n            <div class=\"border-bottom\">\n              <div class=\"d-flex align-items-center justify-content-center\" id=\"messages-user-info-profile-picture\"><p class=\"messages-user-info-picture text-center\"><img src=\"https://api.youth-initiatives.com/api/attachments/5ea17b4404c76d2966040e3c\"></p></div>\n                <h5 class=\"text-center\" id=\"messages-user-info-name\"><a href=\"user-profile-view.html?userId=5ea17ae904c76d2966040e3b\">adela popa</a></h5>\n                <p class=\"text-center\" id=\"messages-user-info-website\">adela.popa2@gmail.com</p>\n              </div>\n              <div class=\"border-bottom pb-3\">\n                <p class=\"text-uppercase font-weight-bold user-profile-focus-title p-3 pb-0 mb-0\">Focus areas</p>\n                <p class=\"p-0 m-0 text-center\" id=\"messages-user-info-domains\"><span class=\"badge badge-pill messages-user-info-badge ml-2\">Children with autism</span><span class=\"badge badge-pill messages-user-info-badge ml-2\">Culture</span><span class=\"badge badge-pill messages-user-info-badge ml-2\">Environment</span><span class=\"badge badge-pill messages-user-info-badge ml-2\">Music</span></p>\n              </div>\n              <div class=\"border-bottom pb-3\">\n                <p class=\"text-uppercase p-3 pb-0 mb-0 font-weight-bold user-profile-shared-title\">Shared Files</p>\n                <div class=\"text-center px-3\" id=\"messages-user-info-shared-files\">\n                  <ul class=\"list-group list-group-flush m-0 shared-resources list-unstyled\">\n                    <li class=\"list-group-item p-0\">\n                      <div class=\"row no-gutters align-items-center pb-3 shared-file-messages-row\">\n                        <div class=\"col-auto\">\n                          <i class=\"cil-file\" style=\"font-size: 25px;\"></i>\n                        </div>\n                        <div class=\"pl-3\">Teoria Vectoril[...]</div>\n                      </div>\n                    </li>\n                    <li class=\"list-group-item p-3 text-left\">\n                      <span><a class=\"text-muted font-weight-bold\" href=\"shared-files.html?userId=5ea17ae904c76d2966040e3b\">See more</a></span>\n                    </li>\n                  </ul>\n                </div>\n              </div>\n            </div>`;\n      }\n\n      $(\"#container-info-chat\").html(contentInfo);\n      $(\"form#send-message-to-user-form\").attr(\"data-reciever-id\", userId);\n      $(\"h5#messages-user-info-name\").html(\n        `<a href=\"user-profile-view.html?userId=${userId}\">${data.name}</a>`\n      );\n      $(\"div#message-board-name\").html(`<span>${data.name}</span>`);\n      if (data.profilePicture) {\n        $(\"div#messages-user-info-profile-picture\").html(\n          `<a href=\"user-profile-view.html?userId=${data.userId}\">\n              <p class=\"messages-user-info-picture text-center\">\n                <img src=\"https://api.youth-initiatives.com/api/attachments/${data.profilePicture}\">\n              </p>\n            </a>`\n        );\n      } else {\n        $(\"div#messages-user-info-profile-picture\").html(\n          `<a href=\"user-profile-view.html?userId=${data.userId}\">\n              <p class=\"messages-user-info-picture text-center\">\n                <img src=\"assets/img/icons/user-avatar-orange-big.svg\" alt=\"Profile Picture\" title=\"Profile Picture\" />\n              </p>\n            </a>`\n        );\n      }\n\n      if (data.showEmail) {\n        $(\"p#messages-user-info-website\").html(data.email);\n      } else {\n        $(\"p#messages-user-info-website\").hide();\n      }\n\n      var domains = [];\n      for (var i = 0; i < data.domains.length; i++) {\n        domains.push(data.domains[i]);\n      }\n      if (data.domains.length) {\n        var authToken = $.cookie(\"authToken\");\n        $.ajax({\n          type: \"GET\",\n          url: baseUrl + \"/api/domains\",\n          headers: { Authorization: \"Bearer \" + authToken },\n          beforeSend: function (xhr) {\n            xhr.setRequestHeader(\"Authorization\", \"Bearer \" + authToken);\n          },\n          success: function (response) {\n            var userDomainBadge = ``;\n            for (var j = 0; j < response.length; j++) {\n              for (var k = 0; k < domains.length; k++) {\n                if (response[j].id == domains[k]) {\n                  userDomainBadge += `<span class=\"badge badge-pill messages-user-info-badge ml-2 mb-2\">${response[j].name}</span>`;\n                  $(\"p#messages-user-info-domains\").html(userDomainBadge);\n                }\n              }\n            }\n          },\n        });\n      }\n    },\n  });\n  loadConversation(userId);\n  showSharedFiles(userId, $.cookie(\"authToken\"));\n}\nfunction changeContent(userId, lastMessageId) {\n  $(\".sidebar-right-content\").addClass(\"d-none d-xl-block\");\n\n  $.ajax({\n    type: \"GET\",\n    url: baseUrl + \"/api/users/userConversation/\" + userId,\n    headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n    crossDomain: true,\n    success: function (data) {\n      var profileGroup = ``;\n      var contentInfo = ``;\n      if (data.admin) {\n        var memberGroupTemplate = ``;\n        var admin = data.admin;\n        var profilePictureAdmin = ``;\n        var profileGroupMember = ``;\n        $.ajax({\n          type: \"GET\",\n          url: baseUrl + \"/api/users/\" + admin,\n          async: false,\n          headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n          success: function (response) {\n            if (response.profilePicture) {\n              profilePictureAdmin = `\n          <div class=\"icon-user-circle\" style=\"opacity: 1 !important;\"> \n              <img class=\"profile-picture-chat-list\" src=\"https://api.youth-initiatives.com/api/attachments/${response.profilePicture}\">\n          </div>`;\n            } else {\n              profilePictureAdmin = `\n              <div class=\"icon-user-circle\">\n                <img src=\"assets/img/icons/user-avatar-orange.svg\" alt=\"Profile Picture\" title=\"Profile Picture\" />\n            </div>\n              `;\n            }\n            memberGroupTemplate += `\n            <div class=\"members d-flex justify-content-between align-items-center px-3 py-2\">\n              <div class=\"d-flex align-items-center\">\n                <a href=\"user-profile-view.html?userId=${response.userId}\">\n                  ${profilePictureAdmin}\n                </a>\n                <p class=\"mb-0 ml-2\">\n                  <a class=\"text-muted text-decoration-none\" href=\"user-profile-view.html?userId=${response.userId}\">\n                    ${response.name}\n                  </a>\n                </p>\n              </div>\n              <div class=\"mb-0 ml-4\">Admin</div>\n            </div>`;\n          },\n        });\n        var membersGroup = data.members;\n        var groupId = data.userId;\n\n        for (var k = 0; k < membersGroup.length; k++) {\n          $.ajax({\n            type: \"GET\",\n            url: baseUrl + \"/api/users/\" + membersGroup[k],\n            headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n            async: false,\n            success: function (response) {\n              if (response.profilePicture) {\n                profileGroupMember = `\n                <div class=\"icon-user-circle\" style=\"opacity: 1 !important;\"> \n                  <img class=\"profile-picture-chat-list\" src=\"https://api.youth-initiatives.com/api/attachments/${response.profilePicture}\">\n                </div>`;\n              } else {\n                profileGroupMember = `\n                  <div class=\"icon-user-circle\">\n                    <img src=\"assets/img/icons/user-avatar-orange.svg\" alt=\"Profile Picture\" title=\"Profile Picture\" />\n                  </div>`;\n              }\n              memberGroupTemplate += `\n                <div class=\"members d-flex justify-content-between px-3 py-2\">\n                  <div class=\"d-flex align-items-center\">\n                    <a href=\"user-profile-view.html?userId=${response.userId}\">\n                      ${profileGroupMember}\n                    </a>\n                    <p class=\"mb-0 ml-2\">\n                      <a class=\"text-muted text-decoration-none\" href=\"user-profile-view.html?userId=${response.userId}\">\n                        ${response.name}\n                      </a>\n                    </p>\n                  </div>\n                  <button class=\"bg-transparent border-0 d-none-if-profile-view dropdown-toggle ml-2\" id=\"edit-group-button-1\" type=\"button\" data-toggle=\"dropdown\" aria-expanded=\"false\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 32 32\">\n                      <defs>\n                        <style>\n                          .stroke {\n                            fill: none;\n                            stroke: transparent;\n                          }\n\n                          .b {\n                            fill: #808e9b;\n                          }\n                        </style>\n                      </defs>\n                      <g transform=\"translate(-1318 -447)\">\n                        <rect class=\"stroke\" width=\"32\" height=\"32\" rx=\"4\" transform=\"translate(1318 447)\"></rect>\n                        <circle class=\"b\" cx=\"2\" cy=\"2\" r=\"2\" transform=\"translate(1326 461)\" style=\"stroke: transparent !important;\"></circle>\n                        <circle class=\"b\" cx=\"2\" cy=\"2\" r=\"2\" transform=\"translate(1332 461)\" style=\"stroke: transparent !important;\"></circle>\n                        <circle class=\"b\" cx=\"2\" cy=\"2\" r=\"2\" transform=\"translate(1338 461)\" style=\"stroke: transparent !important;\"></circle>\n                      </g>\n                    </svg>\n                  </button>\n                  <div class=\"dropdown-menu\" aria-labelledby=\"#edit-group-button-3\">\n                    <a class=\"dropdown-item\" id=\"delete-user-from-group\" data-delete-id=\"${response.userId}\">Delete user</a></div>\n                </div>`;\n            },\n          });\n        }\n        if (data.profilePicture) {\n          profileGroup = `\n            <div class=\"icon-user-circle-overflow-auto position-relative\" id=\"messages-user-info-profile-picture-image\" style=\"opacity: 1 !important;\">\n              <div class=\"profile-picture-group-wrapper d-flex align-items-center justify-content-center overflow-hidden\">\n                <img class=\"profile-picture-group h-100\" src=\"https://api.youth-initiatives.com/api/attachments/${data.profilePicture}\">\n              </div>\n              <button class=\"button-upload-photo position-absolute\" id=\"upload-group-image\" data-toggle=\"modal\" data-target=\"#modal-upload-picture-group\">\n                <div class=\"icon-user-circle\" id=\"upload-group\"><i class=\"cil-camera\"></i></div>\n              </button>\n            </div>`;\n        } else {\n          profileGroup = `\n  <div class=\"icon-user-circle-overflow-auto position-relative\" id=\"messages-user-info-profile-picture-image\">\n    <svg id=\"icon-user-group\" xmlns=\"http://www.w3.org/2000/svg\" width=\"17\" height=\"19\" viewBox=\"0 0 17 19\">\n      <defs>\n        <style>\n          .a {\n            fill: none;\n            stroke: #1e272e;\n            stroke-linecap: round;\n            stroke-linejoin: round;\n          }\n        </style>\n      </defs>\n      <g transform=\"translate(-5.5 -4)\">\n        <path class=\"a\" d=\"M22,28.5v-2a4,4,0,0,0-4-4H10a4,4,0,0,0-4,4v2\" transform=\"translate(0 -6)\"></path>\n        <path class=\"a\" d=\"M20,8.5a4,4,0,1,1-4-4,4,4,0,0,1,4,4Z\" transform=\"translate(-2 0)\"></path>\n      </g>\n    </svg>\n    <button class=\"button-upload-photo position-absolute\" id=\"upload-group-image\" data-toggle=\"modal\" data-target=\"#modal-upload-picture-group\">\n      <div class=\"icon-user-circle\" id=\"upload-group\"><i class=\"cil-camera\"></i></div>\n    </button>\n  </div>\n  `;\n        }\n\n        var contentAddMember = ``;\n        var members = data.members;\n        var filteredMembers = [];\n        var entityId = data.userId;\n        var adminGroup = data.admin;\n        $.ajax({\n          type: \"GET\",\n          url: baseUrl + \"/api/users/\" + $.cookie(\"authUserId\"),\n          async: false,\n          headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n          success: function (response) {\n            let userConnections = response.connections;\n\n            userConnections.map((conn) => {\n              if (!members.includes(conn.userId)) {\n                filteredMembers.push(conn.userId);\n              }\n            });\n          },\n        });\n\n        const noAdminGroupMembers = [];\n\n        filteredMembers.map((el) => {\n          if (adminGroup !== el) {\n            noAdminGroupMembers.push(el);\n          }\n        });\n\n        noAdminGroupMembers.map((member) => {\n          $.ajax({\n            type: \"GET\",\n            url: baseUrl + \"/api/users/\" + member,\n            async: false,\n            headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n            success: function (response) {\n              var pic = ``;\n              if (response.profilePicture) {\n                pic = `\n                <div class=\"icon-user-circle\" style=\"opacity: 1 !important;\"> \n              <img class=\"profile-picture-chat-list\" src=\"https://api.youth-initiatives.com/api/attachments/${response.profilePicture}\">\n          </div>`;\n              } else {\n                pic = `<div class=\"icon-user-circle\">\n                <img src=\"assets/img/icons/user-avatar-orange.svg\" alt=\"Profile Picture\" title=\"Profile Picture\" />\n            </div>`;\n              }\n              contentAddMember += `\n              <div class=\"row py-2 no-gutters align-items-center justify-content-between\" id=\"content-user-group\">\n                    <div class=\"col-auto px-3 w-25 d-flex align-items-center\">\n                    <input type=\"checkbox\" data-user-group-id=\"${member}\" id=\"input-group-users\">\n                      <div class=\"icon-wrapper\">\n                        ${pic}\n                    </div>\n                  </div>\n                  <div class=\"col\">\n                    <span class=\"pl-3\" id=\"user-member-name\">\n                      ${response.name}\n                    </span>\n                  </div>\n                </div>    \n            \n            `;\n            },\n          });\n        });\n        contentInfo = `\n        <div class=\"c-sidebar-nav right-sidebar-members-menu d-none d-xl-block\">\n          <div class=\"border-bottom d-flex align-items-center justify-content-center flex-column pb-4\">\n            ${profileGroup}\n            <div id=\"message-board-name\" class=\"font-weight-bold mt-3 mb-0\" data-group-id=${data.userId}></div>     \n            <button class=\"border-0 a add-new-group-message bg-transparent ml-2 mt-2 mb-2 mr-1 p-0 m-0\" type=\"button\" data-toggle=\"modal\" data-target=\"#edit-group-modal\">\n            <img src=\"assets/img/icons/edit.png\" style=\"width:20px; heigth:auto;\" alt=\"Add contact\" title=\"Add contact\" />\n            </button>     \n            </div>\n          <div class=\"members-group\">\n            <p class=\"text-muted font-weight-bold mt-3 px-3\">MEMBERS</p>\n            <div class=\"content-members\">\n              <div class=\"add-member d-flex align-items-center px-3 py-2\" data-toggle=\"modal\" data-target=\"#modal-add-member-to-group\">\n                <div class=\"icon-user-circle mr-2\"><i class=\"cil-plus\"></i></div>\n                <p class=\"m-0\">Add member</p>\n              </div>\n                ${memberGroupTemplate}\n            </div>\n          </div>\n        </div>\n        <div class=\"modal\" tabindex=\"-1\" role=\"dialog\" id=\"modal-upload-picture-group\" aria-modal=\"true\" data-user-id = ${data.userId}>\n          <div class=\"modal-dialog\" role=\"document\">\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h5 class=\"modal-title\">Upload group picture</h5>\n                <button class=\"close text-dark\" type=\"button\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\"></span></button>\n              </div>\n              <form class=\"p-3\" id=\"upload-profile-group-form\" data-group-id=\"${data.userId}\">\n                <input id=\"upload-profile-group-input\" type=\"file\" style=\"display: none\" name=\"attachment\" accept=\"image/*\">\n                <div class=\"row\">\n                  <div class=\"col-sm-6\">\n                    <label class=\"custom-file-upload-label choose-file-shared-files d-flex align-items-center justify-content-center\" for=\"upload-profile-group-input\">\n                      <div>\n                        <div class=\"text-center mb-3\"><i class=\"cil-cloud-download\"></i></div>\n                        <div class=\"text-center\">Click here to upload<br>your file</div>\n                      </div>\n                    </label>\n                  </div>\n                  <div class=\"col-sm-6 text-wrap\">\n                    <p class=\"d-flex align-items-center file-name-attachment\"><span class=\"d-none file-icon\"><i class=\"cil-file\"></i></span><span id=\"file-name\"></span></p>\n                  </div>\n                </div>\n                <div class=\"modal-footer\">\n                  <button class=\"btn btn-secondary\" type=\"button\" data-dismiss=\"modal\">Close</button>\n                  <button class=\"btn btn-primary\" id=\"btnSubmit\" type=\"submit\">Submit</button>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal\" tabindex=\"-1\" role=\"dialog\" id=\"modal-add-member-to-group\" aria-modal=\"true\">\n          <div class=\"modal-dialog\" role=\"document\">\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h5 class=\"modal-title\">Add member</h5>\n                <button class=\"close text-dark\" type=\"button\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\"></span></button>\n              </div>\n              <form id=\"add-member-to-group-form\" data-groupid=\"${groupId}\">\n                <div class=\"modal-body\">\n                  <p class=\"p-0 mb-1\">Add member</p>\n                  <input class=\"form-control pl-2\" id=\"search-add-members\" type=\"text\" placeholder=\"Search members\" aria-label=\"Username\" aria-describedby=\"basic-addon1\">\n                  <div class=\"content-members-group\">\n                    ${contentAddMember}\n              </div>\n            </div>\n            <div class=\"modal-footer\">\n              <button class=\"btn btn-secondary\" type=\"button\" data-dismiss=\"modal\">Close</button>\n              <button class=\"btn btn-primary\" id=\"add-member-button\" type=\"submit\">Submit</button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>`;\n        $(\"#message-board-name\").html(`<span>${data.name}</span>`);\n      } else {\n        contentInfo = `\n          <div class=\"c-sidebar-nav right-sidebar-members-menu d-none d-xl-block\">\n            <div class=\"border-bottom pb-3\">\n              <div class=\"d-flex align-items-center justify-content-center\" id=\"messages-user-info-profile-picture\"><p class=\"messages-user-info-picture text-center\"><img src=\"https://api.youth-initiatives.com/api/attachments/5ea17b4404c76d2966040e3c\"></p></div>\n                <h5 class=\"text-center\" id=\"messages-user-info-name\"><a class=\"text-muted\" href=\"user-profile-view.html?userId=5ea17ae904c76d2966040e3b\">adela popa</a></h5>\n                <p class=\"text-center text-muted\" id=\"messages-user-info-website\">adela.popa2@gmail.com</p>\n              </div>\n              <div class=\"border-bottom pb-3\">\n                <p class=\"text-uppercase font-weight-bold user-profile-focus-title p-3 pb-0 mb-0\">Focus areas</p>\n                <p class=\"p-0 m-0 text-center\" id=\"messages-user-info-domains\"><span class=\"badge badge-pill messages-user-info-badge ml-2\">Children with autism</span><span class=\"badge badge-pill messages-user-info-badge ml-2\">Culture</span><span class=\"badge badge-pill messages-user-info-badge ml-2\">Environment</span><span class=\"badge badge-pill messages-user-info-badge ml-2\">Music</span></p>\n              </div>\n              <div class=\"border-bottom pb-3\">\n                <p class=\"text-uppercase p-3 pb-0 mb-0 font-weight-bold user-profile-shared-title\">Shared Files</p>\n                <div class=\"text-center px-3\" id=\"messages-user-info-shared-files\">\n                  <ul class=\"list-group list-group-flush m-0 shared-resources list-unstyled\">\n                    <li class=\"list-group-item p-0\">\n                      <div class=\"row no-gutters align-items-center pb-3 shared-file-messages-row\">\n                        <div class=\"col-auto\">\n                          <i class=\"cil-file\" style=\"font-size: 25px;\"></i>\n                        </div>\n                        <div class=\"pl-3\">Teoria Vectoril[...]</div>\n                      </div>\n                    </li>\n                    <li class=\"list-group-item p-3 text-left\">\n                      <span><a class=\"font-weight-bold text-muted\" href=\"shared-files.html?userId=5ea17ae904c76d2966040e3b\">See more</a></span>\n                    </li>\n                  </ul>\n                </div>\n              </div>\n            </div>`;\n      }\n\n      $(\"#container-info-chat\").html(contentInfo);\n      $(\"form#send-message-to-user-form\").attr(\"data-reciever-id\", userId);\n      $(\"h5#messages-user-info-name\").html(\n        `<a class=\"text-muted\" href=\"user-profile-view.html?userId=${userId}\">${data.name}</a>`\n      );\n      $(\"div#message-board-name\").html(`<span>${data.name}</span>`);\n      if (data.profilePicture) {\n        $(\"div#messages-user-info-profile-picture\").html(\n          `<a href=\"user-profile-view.html?userId=${data.userId}\">\n            <p class=\"messages-user-info-picture text-center\">\n              <img src=\"https://api.youth-initiatives.com/api/attachments/${data.profilePicture}\">\n            </p>\n          </a>`\n        );\n      } else {\n        $(\"div#messages-user-info-profile-picture\").html(\n          `<a href=\"user-profile-view.html?userId=${data.userId}\">\n            <p class=\"messages-user-info-picture text-center\">\n              <img src=\"https://via.placeholder.com/80\">\n            </p>\n          </a>`\n        );\n      }\n      if (data.showEmail) {\n        $(\"p#messages-user-info-website\").html(data.email);\n      } else {\n        $(\"p#messages-user-info-website\").hide();\n      }\n\n      var domains = [];\n      for (var i = 0; i < data.domains.length; i++) {\n        domains.push(data.domains[i]);\n      }\n      if (data.domains.length) {\n        var authToken = $.cookie(\"authToken\");\n        $.ajax({\n          type: \"GET\",\n          url: baseUrl + \"/api/domains\",\n          headers: { Authorization: \"Bearer \" + authToken },\n          beforeSend: function (xhr) {\n            xhr.setRequestHeader(\"Authorization\", \"Bearer \" + authToken);\n          },\n          success: function (response) {\n            var userDomainBadge = ``;\n            for (var j = 0; j < response.length; j++) {\n              for (var k = 0; k < domains.length; k++) {\n                if (response[j].id == domains[k]) {\n                  userDomainBadge += `<span class=\"badge badge-pill messages-user-info-badge ml-2 mb-2\">${response[j].name}</span>`;\n                  $(\"p#messages-user-info-domains\").html(userDomainBadge);\n                }\n              }\n            }\n          },\n        });\n      }\n    },\n  });\n  loadConversation(userId);\n  showSharedFiles(userId, $.cookie(\"authToken\"));\n}\nfunction filterUserMessages() {\n  $(document).on(\"keyup\", \"input#search-users-input\", function () {\n    var value = $(this).val().toLowerCase();\n    $(\"div.messages-list\")\n      .children()\n      .each(function () {\n        var name = $(this)\n          .find(\"span#chat-menu-user-name\")\n          .text()\n          .toLowerCase();\n        $(this).toggle(name.toLowerCase().indexOf(value) > -1);\n      });\n  });\n}\nfunction addNewContactMessage() {\n  $(document).on(\"click\", \"a.add-new-contact-message\", function (e) {\n    e.preventDefault();\n    $(\"div.messages-list\")\n      .children()\n      .each(function () {\n        $(this).removeClass(\"active\");\n      });\n    $(\".tab-content\")\n      .children()\n      .each(function () {\n        $(this).removeClass(\"active\").removeClass(\"show\");\n      });\n    $(\"#v-pills-new-message\").addClass(\"active\").addClass(\"show\");\n    $(\".messages-content\").removeClass(\"col-xl-8\").addClass(\"col-xl-12\");\n    $(\".sidebar-right-content\").addClass(\"d-none\").removeClass(\"d-xl-block\");\n  });\n  $(document).on(\"click\", \"a#messages-list-item\", function () {\n    $(this).addClass(\"active\").addClass(\"show\");\n    var userId = $(this).attr(\"data-user-id\");\n    $(\"#v-pills-new-message\").removeClass(\"active\").removeClass(\"show\");\n    $(\"#v-pills-home\").addClass(\"active\").addClass(\"show\");\n\n    $(\".messages-content\").addClass(\"col-xl-8\").removeClass(\"col-xl-12\");\n    $(\".sidebar-right-content\").removeClass(\"d-none\");\n    var lastMessageId = $(this).attr(\"data-last-message\");\n    if (lastMessageId) {\n      changeContent(userId, lastMessageId);\n    } else {\n      changeContentNoMessage(userId);\n    }\n  });\n}\n\nfunction tagSelectorInit() {\n  let userId = $.cookie(\"authUserId\");\n  let authToken = $.cookie(\"authToken\");\n\n  $.ajax({\n    type: \"GET\",\n    url: baseUrl + \"/api/users/\" + userId,\n    headers: { Authorization: \"Bearer \" + authToken },\n    beforeSend: function (xhr) {\n      xhr.setRequestHeader(\"Authorization\", \"Bearer \" + authToken);\n    },\n    success: function (response) {\n      let connections = response.connections;\n      $(\".connections-search-select2\").select2({\n        templateResult: formatState,\n      });\n      $(\"span.select2.select2-container.select2-container--default\").addClass(\n        \"form-control\"\n      );\n      if (connections.length) {\n        for (var i = 0; i < connections.length; i++) {\n          var domainTemplate = ``;\n          var connectionMessageTemplate = ``;\n\n          var connectionId = connections[i].userId;\n          $.ajax({\n            type: \"GET\",\n            url: baseUrl + \"/api/users/\" + connectionId,\n            headers: { Authorization: \"Bearer \" + authToken },\n            beforeSend: function (xhr) {\n              xhr.setRequestHeader(\"Authorization\", \"Bearer \" + authToken);\n            },\n            success: function (response) {\n              var profilePictureAddMemberTemplate = ``;\n              var contentAddMember = ``;\n              if (response.userType == \"SINGLE_USER\") {\n                if (response.profilePicture) {\n                  profilePictureAddMemberTemplate = `\n                  <div class=\"icon-user-circle\" style=\"opacity: 1 !important;\">\n                    <img class=\"profile-picture-connections\" src=\"https://api.youth-initiatives.com/api/attachments/${response.profilePicture}\">\n                  </div>\n                  `;\n                } else {\n                  profilePictureAddMemberTemplate = `\n                        <div class=\"icon-user-circle\">\n                            <img src=\"assets/img/icons/user-avatar-orange.svg\" alt=\"Profile Picture\" title=\"Profile Picture\" />\n                        </div>\n                  `;\n                }\n                contentAddMember = `\n                <div class=\"row py-2 no-gutters align-items-center justify-content-between\" id=\"content-user-group\">\n                  <div class=\"col-auto px-3 w-25 d-flex align-items-center\">\n                    <input type=\"checkbox\" data-user-group-id=${response.userId} id=\"input-group-users\">\n                    <div class=\"icon-wrapper\">\n                      ${profilePictureAddMemberTemplate}\n                    </div>\n                  </div>\n                  <div class=\"col\">\n                      <span class=\"pl-3\" id=\"user-member-name\"> \n                          ${response.name}\n                      </span>\n                  </div>\n              </div>\n                `;\n                $(\".content-members-group\").append(contentAddMember);\n              }\n            },\n          });\n\n          domainTemplate = `\n              <option value=\"${connections[i].profilePicture}\" data-user-id=\"${connections[i].userId}\">\n                ${connections[i].name}\n                </option>`;\n\n          $(\"select.connections-search-select2\").append(domainTemplate);\n\n          var profilePictureMessagesGroup = ``;\n          if (connections[i].profilePicture) {\n            profilePictureMessagesGroup = `\n            <div class=\"icon-user-circle\" style=\"opacity: 1 !important;\">\n              <img class=\"profile-picture-connections\" src=\"https://api.youth-initiatives.com/api/attachments/${connections[i].profilePicture}\">\n            </div>\n            `;\n          } else {\n            profilePictureMessagesGroup = `\n          <div class=\"icon-user-circle\">\n              <img src=\"assets/img/icons/user-avatar-orange.svg\" alt=\"Profile Picture\" title=\"Profile Picture\" />\n            </div>\n            `;\n          }\n          connectionMessageTemplate = `\n          <div class=\"row py-2 no-gutters align-items-center justify-content-between\" id=\"content-user-group\">\n            <div class=\"col-auto px-3 w-25 d-flex align-items-center\">\n            <input type=\"checkbox\" data-user-group-id=${connections[i].userId} id=\"input-group-users\">\n              <div class=\"icon-wrapper\">\n                ${profilePictureMessagesGroup}\n              </div>\n            </div>\n            <div class=\"col\">\n              <span class=\"pl-3\" id=\"user-member-name\">\n                  ${connections[i].name}\n              </span>\n            </div>\n          </div>\n          `;\n          $(\".connection-template-message-group\").append(\n            connectionMessageTemplate\n          );\n\n          $(\"input[type='checkbox']\").bind(\"click\", function () {\n            $(this).attr(\"checked\", $(this).is(\":checked\"));\n          });\n        }\n      } else {\n        $(\".no-domain-message\").removeClass(\"d-none\");\n      }\n    },\n    error: function () {\n      alert(\"Connections listing failed!\");\n    },\n  });\n}\n\nfunction formatState(state) {\n  if (!state.id) {\n    return state.text;\n  }\n  var baseUrl = \"https://api.youth-initiatives.com/api/attachments\";\n  var $state = \"\";\n  if (state.element.value === \"null\") {\n    $state = $(\n      '<span><img class=\"img-flag\" src=\"https://via.placeholder.com/80\" alt=\"profile picture\"> ' +\n        state.text +\n        \"</span>\"\n    );\n  } else {\n    $state = $(\n      '<span><img src=\"' +\n        baseUrl +\n        \"/\" +\n        state.element.value +\n        '\" class=\"img-flag\" /> ' +\n        state.text +\n        \"</span>\"\n    );\n  }\n\n  return $state;\n}\nfunction showSharedFiles(userId, authToken) {\n  $.ajax({\n    type: \"GET\",\n    url:\n      baseUrl +\n      \"/api/users/\" +\n      userId +\n      \"/attachments?page=0&size=10&sort=createdAt,desc\",\n    headers: { Authorization: \"Bearer \" + authToken },\n    crossDomain: true,\n    success: function (data) {\n      var files = data.content;\n      if (files.length) {\n        var messagesInfoSharedFile = ``;\n        for (var i = 0; i < files.length; i++) {\n          if (i < 5) {\n            var fileNameMessage = files[i].title;\n            if (fileNameMessage.length > 15) {\n              fileNameMessage = fileNameMessage.substring(0, 15) + \"[...]\";\n            }\n            var paddingFiles = \"pb-3\";\n            if (i !== 0) {\n              paddingFiles = \"py-3\";\n            }\n            messagesInfoSharedFile += `\n                <li class=\"list-group-item p-0\">\n                  <div class=\"row no-gutters align-items-center ${paddingFiles} shared-file-messages-row\">\n                    <div class=\"col-auto\">\n                      <i class=\"cil-file\" style=\"font-size: 25px;\"></i>\n                    </div>\n                    <div class=\"pl-3\">${fileNameMessage}</div>\n                  </div>\n                </li>`;\n          }\n        }\n        messagesInfoSharedFile += `\n        <li class=\"list-group-item p-3 text-left\">\n          <span><a class=\"font-weight-bold text-muted\" href=\"shared-files.html?userId=${userId}\">See more</a></span>\n        </li>`;\n        $(\"ul.shared-resources\").html(messagesInfoSharedFile);\n      } else {\n        $(\"ul.shared-resources\")\n          .html(\"This user has no uploaded files\")\n          .addClass(\"mb-2\");\n      }\n    },\n  });\n}\nfunction sortConnection() {\n  $(document).on(\"keyup\", \"input#search-for-group\", function () {\n    var value = $(this).val().toLowerCase();\n    $(\".connection-template-message-group\")\n      .children()\n      .each(function () {\n        var name = $(this).text().toLowerCase();\n\n        $(this).toggle(name.toLowerCase().indexOf(value) > -1);\n      });\n  });\n}\nfunction sendMessagesPressingEnter() {\n  $(\"form#send-message-to-user-form textarea\").keypress(function (e) {\n    if (e.keyCode == 13 && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  });\n}\nfunction sendMessageClickingButton() {\n  $(\"a#send-message\").on(\"click\", function (e) {\n    e.preventDefault();\n\n    sendMessage();\n  });\n}\nvar attachId = \"\";\nvar fileName = \"\";\n\nfunction uploadPictures() {\n  var attachemntIds = [];\n\n  var files = $(\"#files\")[0].files;\n\n  for (var i = 0; i < files.length; i++) {\n    let jsonArray = new FormData();\n    jsonArray.append(\"attachment\", files[i]);\n    jsonArray.append(\"title\", files[i].name);\n\n    console.log(jsonArray.getAll(\"attachment\"));\n    for (var key of jsonArray.entries()) {\n      console.log(key[0] + \", \" + key[1]);\n    }\n\n    var opts = {\n      url: baseUrl + \"/api/attachments\",\n      data: jsonArray,\n      cache: false,\n      async: false,\n      contentType: false,\n      processData: false,\n      method: \"POST\",\n      type: \"POST\", // For jQuery < 1.9\n      headers: {\n        Authorization: \"Bearer \" + $.cookie(\"authToken\"),\n      },\n      success: function (data) {\n        var fileNameCreatePost = files[i].name;\n        fileName = files[i].name;\n        if (fileNameCreatePost.length > 20) {\n          fileNameCreatePost = fileNameCreatePost.substring(0, 20) + \"[...]\";\n        }\n\n        $(\"div#file-name\").append(`\n      <div class=\"d-flex justify-content-between align-items-center mb-3 w-75\" data-attachment-id=\"${\n        data.id\n      }\">\n        <div class=\"d-flex align-items-center\">\n            <div><i class=\"cil-file\" style=\"font-size: 30px; padding-right:10px;\"></i></div>\n            <div>${fileNameCreatePost ? fileNameCreatePost : \"filename\"}</div>\n        </div>\n        <div id=\"delete-attachment\" class=\"p-2\" style=\"cursor: pointer\">\n            <i class=\"cil-x text-dark\"></i>\n        </div>\n    </div>\n    `);\n        attachemntIds.push(data.id);\n        attachId = data.id;\n      },\n    };\n    if (jsonArray.fake) {\n      // Make sure no text encoding stuff is done by xhr\n      opts.xhr = function () {\n        var xhr = jQuery.ajaxSettings.xhr();\n        xhr.send = xhr.sendAsBinary;\n        return xhr;\n      };\n      opts.contentType = \"multipart/form-data; boundary=\" + jsonArray.boundary;\n      opts.data = jsonArray.toString();\n    }\n    let response = jQuery.ajax(opts);\n  }\n}\n\nfunction sendMessage() {\n  var message = $(\"form#send-message-to-user-form textarea\").val();\n  var recieverId = $(\"form#send-message-to-user-form\").attr(\"data-reciever-id\");\n  var currentUserIdToken = $.cookie(\"authToken\");\n\n  if (message.length > 0) {\n    $.ajax({\n      type: \"POST\",\n      contentType: \"application/x-www-form-urlencoded\",\n      url: baseUrl + \"/api/users/sendMessage/\" + recieverId,\n      headers: {\n        Authorization: \"Bearer \" + currentUserIdToken,\n      },\n      data: {\n        message: message,\n        attachmentId: attachId,\n      },\n      success: function () {\n        $(\"form#send-message-to-user-form textarea\").val(\"\");\n        var templateMessage = `\n            <div class=\"message\">\n              <div class=\"user-message\">\n                <div class=\"d-flex align-items-start justify-content-end\">\n                  <div class=\"message\">\n                    <p class=\"m-0\">${message}</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          `;\n        $(\".message-page-wrapper-content\").append(templateMessage);\n        $(\".message-page-wrapper-content\").scrollTop(\n          $(\".message-page-wrapper-content\").prop(\"scrollHeight\")\n        );\n      },\n      error: function (error) {},\n    });\n  } else {\n    if (attachId.length > 0) {\n      $.ajax({\n        type: \"POST\",\n        contentType: \"application/x-www-form-urlencoded\",\n        url: baseUrl + \"/api/users/sendMessage/\" + recieverId,\n        headers: {\n          Authorization: \"Bearer \" + currentUserIdToken,\n        },\n        data: {\n          message: fileName,\n          attachmentId: attachId,\n        },\n        success: function () {\n          $(\"form#send-message-to-user-form input\").val(\"\");\n          if (fileName > 15) {\n            fileName = fileName.substring(0, 15) + \"[...]\";\n          }\n          var templateMessage = `\n              <div class=\"message\">\n                <div class=\"user-message\">\n                  <div class=\"d-flex align-items-start justify-content-end\">\n                    <div class=\"message\">\n                    <a href=\"https://api.youth-initiatives.com/api/attachments/${attachId}\" class=\"m-0\"><i class=\"cil-arrow-thick-to-bottom\"></i>  ${fileName}</a>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            `;\n          $(\".message-page-wrapper-content\").append(templateMessage);\n          $(\".message-page-wrapper-content\").scrollTop(\n            $(\".message-page-wrapper-content\").prop(\"scrollHeight\")\n          );\n        },\n        error: function (error) {},\n      });\n    }\n  }\n}\nfunction loadConversation(userId) {\n  var iconUserCircle = ``;\n\n  $.ajax({\n    type: \"GET\",\n    url: baseUrl + \"/api/users/\" + userId,\n    async: false,\n    headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n    success: function (response) {\n      var profilePicture = `\n      <a class=\"w-100 h-100\" href=\"user-profile-view.html?userId=${response.userId}\">\n        <img src=\"https://api.youth-initiatives.com/api/attachments/${response.profilePicture}\" alt=\"profile picture\">\n      </a>`;\n      if (profilePicture != null) {\n        iconUserCircle = profilePicture;\n      } else {\n        iconUserCircle = `\n      <div class=\"icon-user-circle profile-picture-user-messages\">\n        <a href=\"user-profile-view.html?userId=${response.userId}\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"17\" height=\"19\" viewbox=\"0 0 17 19\">\n              <defs>\n                <style> a{\n                    fill: none;\n                    stroke: #1e272e;\n                    stroke-linecap: round;\n                    stroke-linejoin: round;\n                  }\n                </style>\n              </defs>\n              <g transform=\"translate(-5.5 -4)\">\n                <path class=\"a\" d=\"M22,28.5v-2a4,4,0,0,0-4-4H10a4,4,0,0,0-4,4v2\" transform=\"translate(0 -6)\"></path>\n                <path class=\"a\" d=\"M20,8.5a4,4,0,1,1-4-4,4,4,0,0,1,4,4Z\" transform=\"translate(-2 0)\"></path>\n              </g>\n            </svg>\n          </a>\n      </div>`;\n      }\n    },\n  });\n  var messagesTemplate = `\n  <div class=\"user-third-party-message\">\n    <div class=\"d-flex align-items-start\">\n        <div class=\"px-2 px-md-4\">\n          <div class=\"profile-picture-user-messages\">\n              ${iconUserCircle}\n          </div>\n        </div>\n        <div class=\"message\">\n            <span class=\"m-0\" id=\"content-message-third-party-user\">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi</span>\n        </div>\n    </div>\n</div>\n<div class=\"user-message\">\n    <div class=\"d-flex align-items-start justify-content-end\">\n        <div class=\"message\">\n            <span class=\"m-0\" id=\"content-message-user\">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi</span>\n        </div>\n    </div>\n</div>\n  `;\n  $(\".message-page-wrapper-content\").html(messagesTemplate);\n  let authUserId = $.cookie(\"authUserId\");\n  $.ajax({\n    type: \"GET\",\n    url: baseUrl + \"/api/users/conversation/\" + userId,\n    headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n    crossDomain: true,\n    success: function (data) {\n      if (data.length) {\n        if (data[data.length - 1].status === \"UNREAD\") {\n          var lastMessageId = data[data.length - 1].id;\n          $.ajax({\n            type: \"POST\",\n            url:\n              baseUrl +\n              \"/api/users/message/\" +\n              lastMessageId +\n              \"/change-status\",\n            headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n            contentType: \"application/x-www-form-urlencoded\",\n            success: function (data) {\n              var conversationsUnread = $(\".message-badge-notification\").text();\n\n              if (conversationsUnread <= 0) {\n                $(\".message-badge-notification\")\n                  .addClass(\"badge-d-none\")\n                  .removeClass(\"badge\");\n              } else {\n                $(\".message-badge-notification\").html(conversationsUnread - 1);\n              }\n              $(\"a[data-last-message*=\" + lastMessageId + \"]\")\n                .find(\"span#chat-menu-user-name\")\n                .removeClass(\"font-weight-bold\");\n            },\n          });\n        }\n      }\n\n      var userMessage = $(\".user-message\");\n      userMessage.hide();\n      var thirdPartyMessage = $(\".user-third-party-message\");\n      thirdPartyMessage.hide();\n      for (var i = 0; i < data.length; i++) {\n        var templateMessages;\n        if (data[i].senderId === authUserId) {\n          templateMessages = userMessage\n            .clone()\n            .show()\n            .appendTo(\".message-page-wrapper-content\");\n        } else {\n          templateMessages = thirdPartyMessage\n            .clone()\n            .show()\n            .appendTo(\".message-page-wrapper-content.w-100\");\n\n          var senderId = data[i].senderId;\n          var groupId = data[i].group;\n          $.ajax({\n            type: \"GET\",\n            url: baseUrl + \"/api/users/\" + senderId,\n            async: false,\n            headers: { Authorization: \"Bearer \" + $.cookie(\"authToken\") },\n            success: function (response) {\n              if (groupId) {\n                templateMessages.prepend(\n                  `<div class=\"ml-4 text-muted\">${response.name}</div>`\n                );\n              }\n\n              if (response.profilePicture) {\n                var profilePicture = `\n                <a class=\"w-100 h-100\" href=\"user-profile-view.html?userId=${response.userId}\">\n                  <img src=\"https://api.youth-initiatives.com/api/attachments/${response.profilePicture}\" alt=\"profile picture\">\n                </a>`;\n                $(\".profile-picture-user-messages\").html(profilePicture);\n              } else {\n                iconUserCircle = `\n                <div class=\"icon-user-circle profile-picture-user-messages\" style=\"opacity: .7; cursor: pointer;\">\n                  <a href=\"user-profile-view.html?userId=${response.userId}\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"17\" height=\"19\" viewbox=\"0 0 17 19\">\n                        <defs>\n                          <style> a{\n                              fill: none;\n                              stroke: #1e272e;\n                              stroke-linecap: round;\n                              stroke-linejoin: round;\n                            }\n                          </style>\n                        </defs>\n                        <g transform=\"translate(-5.5 -4)\">\n                          <path class=\"a\" d=\"M22,28.5v-2a4,4,0,0,0-4-4H10a4,4,0,0,0-4,4v2\" transform=\"translate(0 -6)\"></path>\n                          <path class=\"a\" d=\"M20,8.5a4,4,0,1,1-4-4,4,4,0,0,1,4,4Z\" transform=\"translate(-2 0)\"></path>\n                        </g>\n                      </svg>\n                  </a>\n                </div>`;\n                $(\".profile-picture-user-messages\").html(iconUserCircle);\n              }\n            },\n          });\n        }\n        if (data[i].attachmentId != null && data[i].attachmentId != \"\") {\n          var newMessage;\n          if (data[i].message.length > 15) {\n            newMessage = data[i].message.substring(0, 15) + \"[...]\";\n          }\n          data[\n            i\n          ].message = `<a href=\"https://api.youth-initiatives.com/api/attachments/${data[i].attachmentId}\" class=\"m-0\"><i class=\"cil-arrow-thick-to-bottom\"></i>  ${newMessage}</a>`;\n          templateMessages.find(\"span\").html(data[i].message);\n          $(\".message-page-wrapper-content\").scrollTop(\n            $(\".message-page-wrapper-content\").prop(\"scrollHeight\")\n          );\n        } else {\n          templateMessages.find(\"span\").html(data[i].message);\n          $(\".message-page-wrapper-content\").scrollTop(\n            $(\".message-page-wrapper-content\").prop(\"scrollHeight\")\n          );\n        }\n      }\n    },\n  });\n}\nfunction submitCreateGroup() {\n  $(document).on(\"submit\", \"form#create-group\", function (e) {\n    e.preventDefault();\n    var members = [];\n    var nameGroup = $(\"input#name-group\").val();\n    $(this)\n      .find(\"input[type=checkbox]\")\n      .each(function () {\n        if ($(this).is(\":checked\")) {\n          var id = $(this).attr(\"data-user-group-id\");\n          members.push(id);\n        }\n      });\n    var authToken = $.cookie(\"authToken\");\n    $.ajax({\n      type: \"POST\",\n      contentType: \"application/json\",\n      url: baseUrl + \"/api/users/createGroup\",\n      headers: {\n        Authorization: \"Bearer \" + authToken,\n      },\n      data: JSON.stringify({\n        name: nameGroup,\n        members: members,\n      }),\n      success: function () {\n        location.reload(true);\n      },\n    });\n  });\n}\n\nfunction submitEditGroup() {\n  $(document).on(\"submit\", \"form#edit-group\", function (e) {\n    e.preventDefault();\n    var nameGroup = $(\"input#edit-name-group\").val();\n    var authToken = $.cookie(\"authToken\");\n    var userId = $(\"#message-board-name\").attr(\"data-group-id\");\n    $.ajax({\n      type: \"POST\",\n      contentType: \"application/json\",\n      url: baseUrl + \"/api/users/\" + userId + \"/nameForMessageGroup\",\n      headers: {\n        Authorization: \"Bearer \" + authToken,\n      },\n      data: nameGroup,\n\n      success: function () {\n        location.reload(true);\n      },\n    });\n  });\n}\n\nfunction addMembersToGroup() {\n  $(document).on(\"submit\", \"form#add-member-to-group-form\", function (e) {\n    e.preventDefault();\n    var members = [];\n    $(this)\n      .find(\"input[type=checkbox]\")\n      .each(function () {\n        if ($(this).is(\":checked\")) {\n          var memberId = $(this).attr(\"data-user-group-id\");\n          members.push(memberId);\n        }\n      });\n\n    var groupId = $(this).attr(\"data-groupid\");\n    var authToken = $.cookie(\"authToken\");\n\n    for (var i = 0; i < members.length; i++) {\n      if (i == members.length - 1) {\n        $.ajax({\n          type: \"POST\",\n          contentType: \"application/json\",\n          async: false,\n          url:\n            baseUrl +\n            \"/api/users/\" +\n            groupId +\n            \"/addMemberToMessageGroup/\" +\n            members[i],\n          headers: {\n            Authorization: \"Bearer \" + authToken,\n          },\n          data: {},\n          success: async () => {\n            location.reload(true);\n          },\n        });\n      } else {\n        $.ajax({\n          type: \"POST\",\n          contentType: \"application/json\",\n          async: false,\n          url:\n            baseUrl +\n            \"/api/users/\" +\n            groupId +\n            \"/addMemberToMessageGroup/\" +\n            members[i],\n          headers: {\n            Authorization: \"Bearer \" + authToken,\n          },\n          data: {},\n          success: function () {},\n        });\n      }\n    }\n  });\n}\nfunction sortAddMembersToGroup() {\n  $(document).on(\"keyup\", \"input#search-add-members\", function () {\n    var value = $(this).val().toLowerCase();\n    $(\".content-members-group\")\n      .children()\n      .each(function () {\n        var name = $(this).text().toLowerCase();\n\n        $(this).toggle(name.toLowerCase().indexOf(value) > -1);\n      });\n  });\n}\nfunction deleteUserFromGroup() {\n  $(document).on(\"click\", \"a#delete-user-from-group\", function () {\n    var userId = $(this).attr(\"data-delete-id\");\n    var groupId = $(\"div#message-board-name\").attr(\"data-group-id\");\n    var authToken = $.cookie(\"authToken\");\n    $.ajax({\n      type: \"DELETE\",\n      url: baseUrl + \"/api/users/\" + userId + \"/remove-from-group/\" + groupId,\n      contentType: \"application/json\",\n      headers: {\n        Authorization: \"Bearer \" + authToken,\n      },\n      crossDomain: true,\n      success: function (response) {\n        window.location.reload(true);\n      },\n    });\n\n    $(this).parent().parent().remove();\n  });\n}\n\nvar userId = $.cookie(\"authUserId\");\nvar authToken = $.cookie(\"authToken\");\n$(\"#files\").on(\"change\", function () {\n  var uploads = $(\"#files\")[0].files;\n  uploadPictures();\n});\n\n$.ajax({\n  type: \"get\",\n  url: baseUrl + \"/api/posts/user/\" + userId,\n  contentType: \"application/json\",\n  headers: {\n    Authorization: \"Bearer \" + authToken,\n  },\n  crossDomain: true,\n  success: function (data) {},\n});\n\n$(\"form#create-post-form\").submit(function (event) {\n  var attachmentIds = [];\n  $(\"div#file-name\")\n    .children()\n    .each(function () {\n      attachmentIds.push($(this).attr(\"data-attachment-id\"));\n    });\n  event.preventDefault();\n  if (\n    !($(\"textarea#post-content\").val() === \"\" && attachmentIds.length === 0)\n  ) {\n    var content = $(\"textarea#post-content\").val();\n    $.ajax({\n      type: \"POST\",\n      url: baseUrl + \"/api/posts\",\n      contentType: \"application/json\",\n      headers: {\n        Authorization: \"Bearer \" + authToken,\n      },\n      crossDomain: true,\n      data: JSON.stringify({\n        userId: userId,\n        content: content,\n        attachments: attachmentIds,\n      }),\n      success: function () {\n        location.reload(true);\n      },\n    });\n  } else {\n    alert(\"Post content missing!\");\n  }\n});\nfunction deleteMessageAttachment() {\n  $(document).on(\"click\", \"#delete-attachment\", function () {\n    $(this).parent().remove();\n  });\n}\n"],"file":"messages.js"}